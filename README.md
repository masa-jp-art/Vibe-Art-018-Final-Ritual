# 無常と再生｜Webインタラクティブアート（p5.js実装）

**テーマ**: 儀式終盤「散逸と還る（無常と再生）」
生命の儚さが大いなる循環へと還り、新たな芽吹きへと繋がるプロセスを、暖色の光・粒子・微生物パターン・自然音の同期で描くインタラクティブ作品です。

## 作品の構成（仕様）
作品は3フェーズの時間的体験で構成されます（仕様書準拠）。

1. **PHASE_1: 散逸/昇華（ASCENT）**
   - デジタル祖霊の姿に見立てた粒子の**ブラー化→粒子化→上昇**。
   - **Perlin ノイズのフローフィールド**で有機的に漂い、加算合成で重なりが発光。
   - 背景は**夕焼け→朝焼け**の暖色グラデーション。

2. **PHASE_2: お別れの儀式（FAREWELL）**
   - 祖霊からの**最後のメッセージ**が中央に静かに表示。
   - 画面の**光の球**をクリック/タップ、またはスペース/手振りジェスチャで**送別**。
   - 粒子が一瞬強く輝き、一斉に画面外へ飛び去る。

3. **PHASE_3: 還る/再生（REBIRTH）**
   - 森/川/海を抽象化したパノラマ的背景をクロスフェード。
   - **反応拡散（Gray-Scott）**の曼荼羅パターン＋**Boids**群（微生物の群れ）。
   - **FFT**解析により、音（マイク入力）と映像が同期し、生命の脈動を表現。

### インタラクション
- **マウス/タッチ**: 粒子に乱流、光の球クリックで送別。
- **キーボード**:
  - `Space` … 送別トリガ
  - `M` … マイク ON/OFF
  - `C` … カメラ ON/OFF（簡易手振り検出）
  - `G` … 品質切替（低/中/高）
  - `F` … 全画面トグル
- **ウェブカメラ**（任意）: 画面に向かって左右に**手を振る動作**で送別トリガ（簡易検出）。
- **マイク**（任意）: 環境音のFFTに連動して、反応拡散のシードや粒子のきらめきが変化。

### アクセシビリティ/セーフティ
- OSの**Reduced Motion**設定を検知し、粒子数やブラー/フラッシュを自動抑制。
- 点滅は3Hz未満、テキストは高コントラストで表示。
- すべての操作はマウス/キーボードで代替可能。

---

## 実装（技術概要）
- **描画**: p5.js（2D Canvas）＋加算合成、Perlinノイズのフローフィールド
- **音**: Web Audio API（p5.sound）、AnalyserNode（FFT）
- **ジェスチャ**: Webカメラのフレーム差分を左右領域で集計する**簡易手振り**検出
- **生成系**: 反応拡散（Gray-Scott 簡易CPU実装）、Boids（分離/整列/結合）
- **パフォーマンス**: 品質トグル（粒子数、反応拡散解像度、Boids個体数を調整）

> 外部APIは使用していません（CDNライブラリのみ）。もし外部APIやクラウド素材を使う場合は、`.env` にキーを置き、サーバ側からプロキシする構成にしてください（フロントエンドに秘密鍵を直置きしない）。

---

## 体験方法（ローカル再生）
ブラウザのメディア許諾の都合で、**ローカルHTTPサーバ**からの起動を推奨します。

### 1) ファイル構成
/project-root

├─ index.html

├─ style.css

├─ sketch.js

├─ README.md

└─ .env.example  (任意/外部API使用時)


### 2) 起動
- **Python**: `python3 -m http.server 8080`
- **Node(http-server)**: `npx http-server -p 8080`

ブラウザで `http://localhost:8080` を開く。
初回に画面をクリックしてから、HUDのボタンで**マイク/カメラ**をONにできます。

---

## 操作ガイド
- マウスで粒子に触れると揺らぎが広がります。
- 画面中央の光の球をクリック/タップ（または `Space`）すると「送別」。
- `M`でマイク、`C`でカメラ、`G`で品質切替、`F`で全画面。

---

## .env（外部APIを使う場合）
この作品はデフォルトで**外部APIを使いません**。将来的に動画CDNや外部音源、TFJSモデルURLなどを環境変数で切り替える場合は、`.env` を使い、**サーバ側でプロキシ**してください。
例:

MEDIA_BASE_URL=[https://your.cdn.example](https://your.cdn.example/)

TFJS_MODEL_URL=https://your.model.host/model.json


> フロントエンドのみの構成では `.env` の秘密情報は安全に保持できません。必ずサーバで隠蔽・中継してください。

---

## トラブルシューティング
- **音が反応しない**: 画面を一度クリック→HUDの「マイク: ON」を押してください。
- **カメラが動作しない**: ブラウザの権限を許可。低光量下では手振り検出が不安定になります。
- **重い**: `G`で品質を「低」に。小さなウィンドウで実行。
- **何も出ない**: ブラウザコンソールにエラーがないか確認し、HTTPサーバ経由で起動してください。

© 無常と再生 – p5.js implementation
